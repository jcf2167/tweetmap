<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
  <title>Tweet Heat</title>
  <style>
  html { height: 80% }
  body { height: 100%; margin: 0; padding: 0 }
  #map-canvas { height: 80% }
  h1 { position:absolute; }
  #panel {
        position: absolute;
        top: 5px;
        left: 50%;
        margin-left: -180px;
        z-index: 5;
        background-color: #fff;
        padding: 5px;
        border: 1px solid #999;
      }
  </style>
  <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
<script type="text/javascript" src="{{ url_for('static', filename='heatmap.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='gmaps-heatmap.js') }}"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=visualization"></script>

</head>
<body>

  <div id="map-canvas" align="center"></div>


  <script>
        // map center
        var myLatlng = new google.maps.LatLng(25.6586, -80.3568);
        // map options,
        var myOptions = {
          zoom: 3,
          center: myLatlng
        };
        // standard map
        map = new google.maps.Map(document.getElementById("map-canvas"), myOptions);
        // heatmap layer
        var liveTweets = new google.maps.MVCArray();

       heatmap = new google.maps.visualization.HeatmapLayer({
          data: liveTweets,
          radius: 25
        });

      var liveTweets_neg = new google.maps.MVCArray();

       heatmap_neg = new google.maps.visualization.HeatmapLayer({
          data: liveTweets_neg,
          radius: 25
        });

       heatmap.setMap(map);


        setTimeout('window.location.href=window.location.href;', 8000);
        //set interval
        //on change 
    
          {% for entry in db %}
                  
                  var tweetLocation = new google.maps.LatLng({{entry[1]}}, {{entry[2]}});
                  
                 
                  {% if entry[4] == "positive"%}
                       liveTweets.push(tweetLocation);
                        console.log("positive tweets")
                  
                  {%else%}
                        console.log("negative tweets")
                        liveTweets_neg.push(tweetLocation)
                  {%endif%}
                  console.log(tweetLocation)

          {% endfor %}

          function toNegative() {
            heatmap_neg.setMap(map);
                        heatmap.setMap(null)

            }
          function toPositive(){
                        heatmap.setMap(map);
                        heatmap_neg.setMap(null)


          }
        </script>

     


    <div id="panel">
      <button onclick="toNegative()">Negative Sentiment</button>
      <button onclick="toPositive()">Positive Sentiment</button>
      <button onclick="changeRadius()">Change radius</button>
      <button onclick="changeOpacity()">Change opacity</button>
    </div>

  </body>
      </html>